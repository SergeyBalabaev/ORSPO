# Task013 ‚Äî CMake: —Ä–∞–±–æ—Ç–∞ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏ –∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è–º–∏ üîç

```
project/
‚îú‚îÄ‚îÄ CMakeLists.txt
‚îú‚îÄ‚îÄ main.c
‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îú‚îÄ‚îÄ CMakeLists.txt
‚îÇ   ‚îú‚îÄ‚îÄ lib.c
‚îÇ   ‚îî‚îÄ‚îÄ lib.h
‚îî‚îÄ‚îÄ build/
```
---
## –†–∞–∑–±–æ—Ä CMakeLists.txt

### –ö–æ—Ä–Ω–µ–≤–æ–π CMakeLists.txt

| –°—Ç—Ä–æ–∫–∞ | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç|
| :--- | :--- | 
| `add_subdirectory(lib)` | –ü–æ–¥–∫–ª—é—á–∞–µ—Ç `CMakeLists.txt` –∏–∑ –ø–∞–ø–∫–∏ `lib` –¥–ª—è —Å–±–æ—Ä–∫–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ |
| `add_executable(myapp main.c)` | –°–æ–∑–¥–∞–µ—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª `myapp` –∏–∑ `main.c` |
| `target_link_libraries(myapp mylib)` |–õ–∏–Ω–∫—É–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º—É —Å –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π `mylib` |
| `target_include_directories(myapp PRIVATE lib)` | –î–æ–±–∞–≤–ª—è–µ—Ç –ø–∞–ø–∫—É `lib` –≤ –ø—É—Ç–∏ –ø–æ–∏—Å–∫–∞ –∑–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –¥–ª—è `myapp` |

### lib/CMakeLists.txt

| –°—Ç—Ä–æ–∫–∞ | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç|
| :--- | :--- | 
| `add_library(mylib STATIC lib.c)` | –°–æ–∑–¥–∞–µ—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É `mylib` –∏–∑ `lib.c` |
| `target_include_directories(mylib PUBLIC ...)` | –£–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ `mylib` –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ç–µ–∫—É—â—É—é –ø–∞–ø–∫—É –≤ –ø—É—Ç–∏ –ø–æ–∏—Å–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ |

**–í–∞–∂–Ω–æ:** `PUBLIC` –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –ø–∞–ø–∫–∞ —Å –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ –Ω—É–∂–Ω–∞ –Ω–µ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å–±–æ—Ä–∫–µ —Å–∞–º–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏, –Ω–æ –∏ –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ –µ—ë –∏—Å–ø–æ–ª—å–∑—É–µ—Ç.

---

## –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è —Å–±–æ—Ä–∫–∏
mkdir build
cd build

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤ —Å–±–æ—Ä–∫–∏
cmake ..

# –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
cmake --build .

# –ó–∞–ø—É—Å–∫ –ø—Ä–æ–≥—Ä–∞–º–º—ã
./myapp
```

---

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Å–±–æ—Ä–∫–∏

```cmake
cmake -DCMAKE_BUILD_TYPE=Release ..
cmake -DCMAKE_BUILD_TYPE=Debug ..
```

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ñ–ª–∞–≥–æ–≤ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏

```cmake
set(CMAKE_C_FLAGS "-Wall -Wpedantic -Werror")
```

### –ò–ª–∏ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ü–µ–ª–∏

```cmake
target_compile_options(myapp PRIVATE -Wall -Wpedantic -Werror)
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏—Å—Ö–æ–¥–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

```cmake
set(SOURCES main.c utils.c math.c)
add_executable(myapp ${SOURCES})
```

### –ü–æ–∏—Å–∫ –±–∏–±–ª–∏–æ—Ç–µ–∫ –≤ —Å–∏—Å—Ç–µ–º–µ

```cmake
find_library(MATH_LIB m)
target_link_libraries(myapp ${MATH_LIB})
```

---

## –ó–∞–¥–∞–Ω–∏–µ 

* –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–±–æ—Ä–∫—É –ø—Ä–æ–µ–∫—Ç–∞ —á–µ—Ä–µ–∑ `CMake`.

* –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º—É –∏ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ–Ω–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç.

* –ò–∑–º–µ–Ω–∏—Ç–µ —Ç–∏–ø –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ —Å `STATIC` –Ω–∞ `SHARED` –≤ `lib/CMakeLists.txt` –∏ –ø–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç.

* –í—ã–ø–æ–ª–Ω–∏—Ç–µ ldd myapp –∏ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏.

* –ó–∞—á–µ–º —Ä–∞–∑–¥–µ–ª—è—Ç—å –ø—Ä–æ–µ–∫—Ç –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ `CMakeLists.txt`?

* –í —á–µ–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É `PRIVATE`, `PUBLIC` –∏ `INTERFACE` –≤ `CMake`?

* –ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç, –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞—Ç—å `target_include_directories` –¥–ª—è `myapp`?
